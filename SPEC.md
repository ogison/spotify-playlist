# Spotify Playlist Player - 仕様書

## プロジェクト概要

Spotifyのプレイリストリンクを入力するだけで、プレイリスト内の各曲を10〜30秒ずつ順番に自動再生できるWebアプリケーション。

## 目的

- Spotifyプレイリストの全体像を短時間で把握できる
- 新しい曲を効率的に発見できる
- かっこいいUIで音楽体験を楽しめる

## 主要機能

### 1. プレイリストURL入力
- **入力形式**: Spotifyのプレイリスト共有リンク
  - 例: `https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M`
- **検証**: URLの形式が正しいかをバリデーション
- **エラー処理**: 無効なURLの場合はエラーメッセージを表示

### 2. プレイリスト情報取得
- **取得データ**:
  - プレイリスト名
  - プレイリストの説明
  - プレイリストカバー画像
  - トラックリスト（曲名、アーティスト名、アルバム画像、プレビューURL）
  - トラック総数

### 3. 自動再生機能
- **再生時間**: 各曲を10〜30秒（ユーザーが設定可能）
- **再生順序**: プレイリスト順に自動で次の曲へ遷移
- **プレビュー**: Spotify APIが提供する30秒プレビューを使用
- **コントロール**:
  - 再生/一時停止
  - 次の曲へスキップ
  - 前の曲へ戻る
  - 再生時間の設定（10秒、15秒、20秒、30秒）
  - シャッフル再生（オプション）

### 4. UI/UX
- **デザインテーマ**: モダンでダークモードのデザイン
- **レイアウト**:
  - ヘッダー: アプリ名とロゴ
  - メインエリア:
    - プレイリストURL入力フォーム
    - 現在再生中のトラック情報（アルバムアート、曲名、アーティスト名）
    - プレイヤーコントロール
    - 再生時間設定
    - プログレスバー（現在の曲の再生位置と全体の進行状況）
  - サイドバー/リスト: トラックリスト表示
- **アニメーション**:
  - 曲切り替え時のフェードイン/アウト
  - プログレスバーのスムーズな動き
  - アルバムアートの回転または拡大効果

### 5. レスポンシブデザイン
- モバイル、タブレット、デスクトップに対応
- モバイルでは縦長レイアウト、デスクトップでは横並びレイアウト

## 技術仕様

### フロントエンド
- **フレームワーク**: Next.js 16 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS 4
- **状態管理**: React hooks (useState, useEffect, useRef)
- **オーディオ再生**: HTML5 Audio API

### バックエンド/API
- **Spotify Web API**: プレイリスト情報とトラック情報の取得
- **認証**: Spotify Client Credentials Flow
- **API Routes**: Next.js API Routes (`/api/spotify/*`)

### 環境変数
```
SPOTIFY_CLIENT_ID=your_client_id
SPOTIFY_CLIENT_SECRET=your_client_secret
```

## データフロー

1. ユーザーがプレイリストURLを入力
2. フロントエンドがプレイリストIDを抽出
3. Next.js API Routeに対してリクエスト
4. API RouteがSpotify APIにアクセストークンをリクエスト
5. API RouteがSpotify APIからプレイリスト情報を取得
6. フロントエンドがプレイリスト情報を受け取り、表示
7. ユーザーが再生ボタンをクリック
8. Audio APIを使用して各トラックのプレビューURLを順番に再生
9. 設定された時間（10〜30秒）が経過したら自動的に次の曲へ

## エラーハンドリング

- **無効なURL**: "有効なSpotifyプレイリストURLを入力してください"
- **プレイリストが見つからない**: "プレイリストが見つかりませんでした"
- **プレビューURLがない曲**: スキップして次の曲へ
- **API制限**: "しばらくしてから再度お試しください"
- **ネットワークエラー**: "接続エラーが発生しました"

## 制限事項

- Spotify APIのプレビューURLは30秒までのため、30秒以上の再生はできない
- プレビューURLが提供されていない曲は再生できない（スキップされる）
- Spotify APIの利用制限に準拠

## 将来的な拡張機能（オプション）

- プレイリストの保存機能
- お気に入り機能
- 複数プレイリストの比較
- カスタムプレイリスト作成機能
- SNS共有機能
